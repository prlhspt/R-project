df_mpg
# Q3.
df_mpg = mpg %>%
filter(!is.na(drv)& !is.na(cty)) %>%
group_by(drv) %>%
summarise(mean_cty = mean(cty))
mpg <- as.data.frame(ggplot2::mpg)
# Q3.
df_mpg = mpg %>%
filter(!is.na(drv)& !is.na(cty)) %>%
group_by(drv) %>%
summarise(mean_cty = mean(cty))
library(plotly)
library(ggplot2)
library(dplyr)
# Q3.
df_mpg = mpg %>%
filter(!is.na(drv)& !is.na(cty)) %>%
group_by(drv) %>%
summarise(mean_cty = mean(cty))
tt = ggplot(data=df_mpg, aes(x=reorder(drv, -mean_cty), y=mean_cty))+
geom_col(fill=rainbow(3))+coord_flip()
ggplotly(tt)
library(plotly)
install.packages("plotly")
library(plotly)
library(ggplot2)
tt = ggplot(data=df_mpg, aes(x=reorder(drv, -mean_cty), y=mean_cty))+
geom_col(fill=rainbow(3))+coord_flip()
ggplotly(tt)
df_mpg
tt = ggplot(data=df_mpg, aes(x=reorder(drv, -mean_cty), y=mean_cty))+
geom_col(fill=rainbow(3))+coord_flip()
ggplotly(tt)
library(plotly)
install.packages("plotly")
library(plotly)
library(gglot2)
library(ggplot2)
library(plotly)
library(ggplot2)
tt = ggplot(data=df_mpg, aes(x=reorder(drv, -mean_cty), y=mean_cty))+
geom_col(fill=rainbow(3))+coord_flip()
ggplotly(tt)
df_mpg
ggplot(data=df_mpg.aes())
ggplot(data=df_mpg.aes(x=drv,  y=mean_cty))+geom_col()
ggplot(data=df_mpg, aes(x=drv,  y=mean_cty))+geom_col()
ggplot(data=df_mpg, aes(x=drv,  y=mean_cty))+geom_col()+coord_flip()+
ylab("도시연비비")+xlab('구동시간')
ggplot(data=df_mpg, aes(x=drv,  y=mean_cty))+geom_col(fill=rainbow(3))+coord_flip()+
ylab("도시연비비")+xlab('구동시간')
ggplot(data=df_mpg, aes(x=reorder(drv_mean_cty),  y=mean_cty))+geom_col(fill=rainbow(3))+coord_flip()+
ylab("도시연비비")+xlab('구동시간')
ggplot(data=df_mpg, aes(x=reorder(drv.mean_cty),  y=mean_cty))+geom_col(fill=rainbow(3))+coord_flip()+
ylab("도시연비비")+xlab('구동시간')
ggplot(data=df_mpg, aes(x=reorder(drv, mean_cty),  y=mean_cty))+geom_col(fill=rainbow(3))+coord_flip()+
ylab("도시연비비")+xlab('구동시간')
install.packages("plotly")
library(plotly)
install.packages("plotly")
ggplotly(tt)
mpg <- as.data.frame(ggplot2::mpg)
mpg[c(65, 124, 131, 153, 212), "hwy"] <- NA
mpg
library(dplyr)
library(ggplot2)
# Q1.
table(is.na(mpg))
table(is.na(mpg$drv))
table(is.na(mpg$hwy))
# Q2.
mpg %>%
group_by(drv) %>%
filter(!is.na(hwy)) %>%
summarise(mean(hwy, ns.na=T))
# Q1.
mpg <- as.data.frame(ggplot2::mpg)                  # mpg 데이터 불러오기
mpg[c(10, 14, 58, 93), "drv"] <- "k"                # drv 이상치 할당
mpg[c(29, 43, 129, 203), "cty"] <- c(3, 4, 39, 42)  # cty 이상치 할당
table(is.na(mpg))
mpg$drv <- ifelse(mpg$drv %in% c(4, "f", "r"), mpg$drv, NA)
# Q2.
boxplot(mpg$cty)$stats
mpg$cty <- ifelse(mpg$cty < 10 | mpg$cty>25,NA, mpg$cty)
table(is.na(mpg$cty))
boxplot(mpg$cty)$stats
# Q3.
df_mpg = mpg %>%
filter(!is.na(drv)& !is.na(cty)) %>%
group_by(drv) %>%
summarise(mean_cty = mean(cty))
df_mpg
install.packages("plotly")
library(plotly)
library(ggplot2)
tt = ggplot(data=df_mpg, aes(x=reorder(drv, -mean_cty), y=mean_cty))+
geom_col(fill=rainbow(3))+coord_flip()
library(ggplot2)
library(ggplot2)
library(plotly)
library(plotly)
library(plotly)
library(plotly)
library(plotly)
library(plotly)
library(plotly)
library(ggplot2)
tt = ggplot(data=df_mpg, aes(x=reorder(drv, -mean_cty), y=mean_cty))+
geom_col(fill=rainbow(3))+coord_flip()
ggplotly(tt)
df_mpg
ggplot(data=df_mpg, aes(x=drv,  y=mean_cty))+geom_col()+coord_flip()+ylab()
install.packages("plotly")
install.packages("plotly")
library(plotly)
library(plotly)
install.packages("plotly")
ggplot(data=mpg, aes(x=displ, y=hwy)) + geom_point()
library(ggplot2)
library(ggplot)
ggplot(data=df_mpg, aes(x=reorder(drv, mean_cty),  y=mean_cty))+geom_col(fill=rainbow(3))+coord_flip()+
ylab("도시연비비")+xlab('구동시간')
ggplotly(tt)
ggplot(data=mpg, aes(x=displ, y=hwy)) + geom_point()
install.packages("plotly")
install.packages("plotly")
install.packages(c("backports", "openssl", "processx"))
install.packages("plotly")
install.packages("plotly")
library(plotly)
install.packages("plotly")
library(plotly)
ggplot(data = mpg, aes(x = displ, y = hwy))+geom_point()+xlim(3, 6)+ylim(10, 20)
midwest=as.data.frame(ggplot2::midwest)
midwest
ggplot(data=midwest.aes(x=poptotal, y=popasian))+geom_point()
ggplot(data=midwest, aes(x=poptotal, y=popasian))+geom_point()
ggplot(data=midwest, aes(x=poptotal, y=popasian))+geom_point()+xlim(0, 5000000)+ylim(0, 10000)
kk=table(mpg$class)
tt=barplot(kk, col=rainbow(8), ylim=c(0, 70))
text(tt, kk, paste0(kk, "대"), pos=3, col=2, cex2)
text(tt, kk, paste0(kk, "대"), pos=3, col=2, cex=2)
text(tt, kk, paste(kk, "대"), pos=3, col=2, cex=2)
text(tt, kk, paste0(kk, "대"), pos=3, col=2, cex=2)
kk=table(mpg$class)
tt=barplot(kk, col=rainbow(8), ylim=c(0, 70))
text(tt, kk, paste(kk, "대"), pos=3, col=2, cex=2)
text(tt, kk, paste0(kk, "대"), pos=3, col=2, cex=2)
tt=barplot(kk, col=rainbow(8), ylim=c(0, 70))
text(tt, kk, paste0(kk, "대"), pos=3, col=2, cex=2)
mpg %>%
filter(class=="suv")
library(ggplot2)
library(dplyr)
mpg %>%
filter(class=="suv")
mpg %>%
filter(class=="suv")
install.packages("plotly")
library(plotly)
install.packages("plotly")
library(ggplot2)
library(plotly)
install.packages("Rtools")
install.packages("plotly")
library(plotly)
setwd("D:/workspace/r/Rdata")
data=read.csv("sales_data_new.csv")
class(data)
he <- data[1:60,]
fr <- data[61:120,]
te <- data[121:180,]
te <- te[-c(42,45,52)]
health_cor <- cor(he[, 5:10])
fruit_cor <- cor(fr[, 5:10])
tea_cor <- cor(te[, 5:10])
corrplot(health_cor, method="number")
library(corrplot)
corrplot(health_cor, method="number")
vars <- c("QTY", "YM", "ITEM_CNT", "PRICE", "MAXTEMP", "SALEDAY","RAIN_DAY","HOLIDAY")
health_cor <- cor(he[, vars])
fruit_cor <- cor(fr[, vars])
tea_cor <- cor(te[, vars])
corrplot(health_cor, method="number")
View(data)
vars <- c("QTY", "ITEM_CNT", "PRICE", "MAXTEMP", "SALEDAY","RAIN_DAY","HOLIDAY")
health_cor <- cor(he[, vars])
fruit_cor <- cor(fr[, vars])
tea_cor <- cor(te[, vars])
corrplot(health_cor, method="number")
lm(he$QTY~he$.)
lm(he$QTY~.)
lm(he$QTY~he$var)
lm(he$QTY~he$vars)
lm(QTY~vars, data=he)
lm(QTY~., data=he)
vars
lm(QTY~vars, he)
vars2 <- c("ITEM_CNT", "PRICE", "MAXTEMP", "SALEDAY","RAIN_DAY","HOLIDAY")
lm(QTY~vars2, data=he)
vars2
lm(QTY~vars2,he)
vars2
m1 <- lm(he$QTY~he$SALEDAY)
lm(QTY~., data=he)
he
he[,vars]
lm(QTY~., data=he[,vars])
m1 = lm(QTY~., data=he[,vars])
summary(m1)
View(he)
he <- data[1:60,]
fr <- data[61:120,]
te <- data[121:180,]
#이상치 제거
he <- he[-c(22,54,39,45,48,37),]
te <- te[-c(42,45,52),]
View(he)
m1 = lm(QTY~., data=he[,vars])
summary(m1)
vars <- c("ITEM_CNT", "PRICE", "SALEDAY","RAIN_DAY")
m1 = lm(QTY~., data=he[,vars])
summary(m1)
m1 = lm(QTY~., data=he[,vars])
vars <- c("ITEM_CNT", "PRICE", "SALEDAY","RAIN_DAY")
m1 = lm(QTY~., data=he[,vars])
vars <- c("QTY", "ITEM_CNT", "PRICE", "SALEDAY","RAIN_DAY")
m1 = lm(QTY~., data=he[,vars])
summary(m1)
vars <- c("QTY", "ITEM_CNT", "MAXTEMP", "SALEDAY","RAIN_DAY","HOLIDAY")
m3 = lm(QTY~., data=te[,vars])
summary(m3)
te <- data[121:180,]
te <- te[-c(41,44,51),]
vars <- c("QTY", "ITEM_CNT", "MAXTEMP", "SALEDAY","RAIN_DAY","HOLIDAY")
m3 = lm(QTY~., data=te[,vars])
summary(m3)
vars <- c("QTY", "ITEM_CNT", "PRICE", "MAXTEMP", "SALEDAY","RAIN_DAY","HOLIDAY")
m2 = lm(QTY~., data=fr[,vars])
summary(m2)
health_cor <- cor(he[, vars])
vars <- c("QTY", "ITEM_CNT", "PRICE", "SALEDAY","RAIN_DAY")
health_cor <- cor(he[, vars])
corrplot(health_cor, method="number")
summary(m1)
health_cor <- cor(he[, vars])
corrplot(health_cor, method="number")
pairs(fruit_cor, panel=panel.smooth)
summary(m2)
he <- data[1:60,]
fr <- data[61:120,]
te <- data[121:180,]
#이상치 제거
he <- he[-c(22,54,39,45,48,37),]
te <- te[-c(41,44,51),]
vars <- c("QTY", "ITEM_CNT", "PRICE", "SALEDAY","RAIN_DAY")
m1 = lm(QTY~., data=he[,vars])
summary(m1)
m1_cor <- cor(m1)
m1_cor <- cor(m1[, vars])
m1
m1_cor <- cor(he[, vars])
corrplot(health_cor, method="number")
summary(m1)
he
helath_cor
he_cor <- cor(he[, vars])
he_cor
summary(m2)
summary(m1)
vars <- c("QTY", "ITEM_CNT", "PRICE", "SALEDAY","RAIN_DAY")
m1 = lm(QTY~., data=he[,vars])
summary(m1)
lm.fit2 <- step(m1,method="both")
vars <- c("QTY", "ITEM_CNT", "PRICE", "MAXTEMP", "SALEDAY","RAIN_DAY","HOLIDAY")
m1 = lm(QTY~., data=he[,vars])
summary(m1)
lm.fit2 <- step(m1,method="both")
summary(m2)
plot(lm.fit2)
lm.fit2 <- step(m1,method="both")
summary(lm.fit2)
vars <- c("QTY", "ITEM_CNT", "PRICE", "MAXTEMP", "SALEDAY","RAIN_DAY","HOLIDAY")
m1 = lm(QTY~., data=he[,vars])
summary(m1)
m1.fit <- step(m1,method="both")
summary(lm.fit)
summary(m1.fit)
he <- data[1:60,]
fr <- data[61:120,]
te <- data[121:180,]
#이상치 제거
he <- he[-c(22,54,39,45,48,37),]
te <- te[-c(41,44,51),]
vars <- c("QTY", "ITEM_CNT", "PRICE", "MAXTEMP", "SALEDAY","RAIN_DAY","HOLIDAY")
m1 = lm(QTY~., data=he[,vars])
summary(m1)
m1.fit <- step(m1,method="both")
summary(m1.fit)
plot(QTY~.,data=he)
he
plot(QTY~.,data=he)
m1.fit <- step(m1,method="both")
summary(m1.fit)
plot(QTY~.,data=he)
#이상치 제거
he <- he[-c(22,54,39,45,48,37),]
te <- te[-c(41,44,51),]
vars <- c("QTY", "ITEM_CNT", "PRICE", "MAXTEMP", "SALEDAY","RAIN_DAY","HOLIDAY")
m1 = lm(QTY~., data=he[,vars])
summary(m1)
m1.fit <- step(m1,method="both")
summary(m1.fit)
vars <- c("QTY", "ITEM_CNT", "PRICE", "MAXTEMP", "SALEDAY","RAIN_DAY","HOLIDAY")
m1 = lm(QTY~., data=he[,vars])
summary(m1)
m1.fit <- step(m1,method="both")
summary(m1.fit)
m1.fit <- step(m1,method="both")
summary(m1.fit)
plot(QTY~.,data=he)
fr <- data[61:120,]
te <- data[121:180,]
#이상치 제거
he <- he[-c(22,54,39,45,48,37),]
te <- te[-c(41,44,51),]
vars <- c("QTY", "ITEM_CNT", "PRICE", "MAXTEMP", "SALEDAY","RAIN_DAY","HOLIDAY")
m1 = lm(QTY~., data=he[,vars])
summary(m1)
#이상치 제거
he <- he[-c(22,54,39,45,48,37),]
te <- te[-c(41,44,51),]
vars <- c("QTY", "ITEM_CNT", "PRICE", "MAXTEMP", "SALEDAY","RAIN_DAY","HOLIDAY")
m1 = lm(QTY~., data=he[,vars])
summary(m1)
m1.fit <- step(m1,method="both")
summary(m1.fit)
